# Runs

    ./main -m 1000 -s rk4 -t 40 -d 0.02 -e 10 -o punto -c gauss  < initial/circle > p
    ./main -m 1000 -s rk4 -t 40 -d 0.02 -e 10 -o punto -c chorin < initial/circle > p
    
    punto -D 2 -c -G p


Axisymetrization: Koumoutsakos, J. Comput. Phys. 1997

   ./main -m 100 -s rk4 -t 12.0 -d 0.04 -e 1 -o punto -c chorin < initial/vorI  > a

   ./main -m 100 -s rk4 -t 1.0 -d 0.04 -e 1 -o punto -c chorin < initial/vorI  > a

   ./main -r 20 -m 200 -s rk4 -t 10.0 -d 0.08 -e 1 -o punto -c chorin < initial/vorI  > a

punto -D 2 -c -G a


# Store

static int
grid(void * p0, int n, const real * x, const real * y, const real * ksi, int step) {
  FILE *f;
  int i;
  int j;
  int k;
  int l;
  int m;
  int nx;
  int ny;
  real coef;
  real dx;
  real dy;
  real ksi0[99999];
  real u;
  real v;
  real xhi;
  real xlo;
  real yhi;
  real ylo;
  int status;
  char path[SIZE];
  struct Core *core;
  struct RemeshParam *p;

  p = p0;
  nx = p->nx;
  ny = p->ny;
  xlo = p->xlo;
  xhi = p->xhi;
  ylo = p->ylo;
  yhi = p->yhi;
  core = p->core;

  if (core->psi == NULL)
    return 0;

  dx = (xhi - xlo) / nx;
  dy = (yhi - ylo) / ny;
  m = nx * ny;
  for (i = 0; i < m; i++)
    ksi0[i] = 0;

  for (k = 0; k < n; k++) {
    l = 0;
    for (j = 0; j < ny; j++) {
	v = ylo + (j + 0.5) * dy;
	for (i = 0; i < nx; i++) {
	  u = xlo + (i + 0.5) * dx;
	  ksi0[l] += ksi[k] * gauss_psi(x[k] - u, y[k] - v, core->param);
	  l++;
	}
    }
  }
  coef = dx * dy;
  for (i = 0; i < m; i++)
    ksi0[i] *= coef;
  snprintf(path, SIZE, "a.%06d.vtk", step);
  fprintf(stderr, "%s: write '%s'\n", me, path);
  if ((f = fopen(path, "w")) == NULL) {
    fprintf(stderr, "%s: fail to open '%s'\n", me, path);
    exit(2);
  }
  status = fprintf(f, "# vtk DataFile Version 2.0\n"
		   "generated by %s\n"
		   "ASCII\n"
		   "DATASET STRUCTURED_POINTS\n"
		   "DIMENSIONS %d %d 1\n"
		   "ORIGIN %.16e %.16e 0\n"
		   "SPACING %.16e %.16e 0\n",
		   me, nx, ny, xlo + dx/2, ylo + dy/2,
		   dx, dy);
  if (status < 0) {
    fprintf(stderr, "%s: fail to write '%s'\n", me, path);
    exit(2);
  }
  fprintf(f, "POINT_DATA %d\n"
	  "SCALARS omega double\n" "LOOKUP_TABLE DEFAULT\n", m);
  for (i = 0; i < m; i++)
    fprintf(f, "%.16e\n", ksi0[i]);
  fclose(f);
  return 0;
}
